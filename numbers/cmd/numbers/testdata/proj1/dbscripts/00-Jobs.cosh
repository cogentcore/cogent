// note: br is browser

func OpenJobs(path string) {
	// set the default plot parameters -- can't do in init.cosh for some unknown reason
	PlotParams.Defaults()
	PlotParams.Title = "Sim Run Data"
	PlotParams.XAxisColumn = "Run"
	PlotParams.LegendColumn = "JobID"
	
	tv := br.NewTabTable("Jobs")
	dt := tv.Table.Table
	JobsTableView = tv
	JobsTable = dt
	dpath := filepath.Join(br.DataRoot, path)
	// fmt.Println("opening data at:", dpath)

	if dt.NumColumns() == 0 {
		br.FormatTableFromCSV(dt, filepath.Join(dpath, "dbformat.csv"))
	}
	
	ds := dirs.Dirs(dpath)
	dt.SetNumRows(len(ds))
	for i, d := range ds {
		dt.SetString("JobID", i, d)
		dp := filepath.Join(dpath, d)
		meta := filepath.Join(dp, "dbmeta.toml")
		if fileExists(meta) {
			md := br.OpenTOML(meta)
			for k, v := range md {
				dt.SetString(k, i, v)
			}
		}
	}
	tv.Table.Sequential()
	br.Update()
}

OpenJobs(DataDir)

